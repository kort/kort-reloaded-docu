\chapter{Umsetzungskonzept}
\label{tb-umsetzungskonzept}
Am 8.3.2016 haben wir an der HSR ein \brand{React Native}-Meetup durchgeführt um die Projekte von den Teilnehmern kennenzulernen. 
Es ging darum, auszutauschen, was für die Software-Entwicklungsumgebung benötigt wird, wie \brand{React Native} am besten erlernt wird und welche Lösungskonzepte es für die Darstellung der Karte gibt.
Hinweise zur Entwicklungsumgebung und den verwendeten Werkzeugen sind im Kapitel \nameref{pm-projektmanagement} beschrieben.
%ToDo: React Native Erfahrungsbericht referenzieren.
Für die Darstellung der Karte mit \brand{React Native} haben wir diese Möglichkeiten ausfindig gemacht:

%Eventuell in Tabelle darstellen:
\begin{itemize}
    \item Extended React Native Map Komponente\footnote{\url{https://github.com/lelandrichardson/react-native-maps}} (empfohlen von Facebook, anstelle der MapView)
    \begin{itemize}
    	\item Haken: Native Map API von Apple iOS und Android SDK nutzen (fest mit Apple/Google Maps verbunden)
	\end{itemize}
	
    \item \brand{React Native} "Map" Komponente\footnote{\url{http://browniefed.com/blog/2015/05/30/create-a-map-with-react-art/}} nutzen
    \begin{itemize}
    	\item Haken: Pattern Fill issue (Raster Tiles) - Es lassen sich keine Bilder, oder Missions-Icons, auf der Karte darstellen.
	\end{itemize}     

    \item MapBox GL Library\footnote{\url{https://libraries.io/npm/react-native-mapbox-gl}} mit Android/iOS SDK  (eventuell mit Offline-Kacheln von\\* osm2vectortiles\footnote{\url{http://osm2vectortiles.org/downloads/}} zu füttern (Vektor Kacheln)
    \begin{itemize}
    	\item Haken: Offline-Unterstützung problematisch.
	\end{itemize}   
	
    \item Portierung von Leaflet nach React\footnote{\url{https://github.com/PaulLeCam/react-leaflet}}
    \item Raster Tiles von Hand anzeigen
\end{itemize}

Die Native Map APIs von \brand{Google} und \brand{Apple} kamen für uns nicht in Frage.
Wir möchten mit unserer App \brand{OpenStreetMap} Daten verbessern und setzen somit aus moralischen Aspekten auch auf die entsprechende Karte.
%Google Lizenz-Grund nicht erwähnt, da eventuell referenziert werden müsste.
Bei der \brand{React Native} Map-Komponente gab es keine Möglichkeit Bilder auf der Karte darzustellen und die Raster-Tiles "von Hand" anzuzeigen wäre schlicht zu aufwendig. 
Es liesse sich auch nur sehr umständlich eine schöne Map designen.

Somit sprang uns als erstes die Portierung von Leaflet für \brand{React} ins Auge. 
Nach dem betrachten vom Code fiel uns aber auf, dass diese Variante eventuell nur möglich ist, wenn die Karte in einer WebView-Komponente von \brand{React Native} dargestellt wird.
Eine Lösung mit der WebView war zu Aufwendig um richtig getestet zu werden. 
Es widerspricht auch der Grundidee, da mit \brand{React Native} native Applikationen entwickelt werden.

Als letzte Möglichkeit blieb die MapBox GL Library.
Diese hat beim Testen auf Anhieb funktioniert und uns überzeugt.
Der einzige Haken wäre das Pricing, welches bei einer sehr hohen Benutzeranzahl (beschränkt auf 50'000) beachtet werden muss.
Den Gedanke zur Offline-Unterstützung hatten wir auch.
Nur gäbe es da Probleme mit der Grösse der App, da die Vektor-Kacheln und die Missionen im Voraus heruntergeladen und mit installiert werden müssten.


Für die Authentifizierung haben wir diese Möglichkeiten evaluiert:

\begin{itemize}
	\item Auth0: react-native-lock (für iOS und Android).\footnote{\url{https://github.com/auth0/react-native-lock}}
	\begin{itemize}
    	\item Haken: Nicht Open Source. Nur unter diesen Bedingungen kostenlos verwendbar:
    	\begin{itemize}
    		\item Der gesamte Code muss frei auf GitHub verfügbar sein.
    		\item Es dar kein Geld für das Open Source Projekt oder für Derivate verlangt werden. 
    		\item Es muss ein Auth0 Badge auf der Webseite hinzugefügt werden.
    		\item Das Projekt darf nicht von einem anderen Unternehmen weitergeführt werden um Einkünfte zu erzielen.
		\end{itemize} 
	\end{itemize} 
	\item eigene Entwicklung
\end{itemize}

\section{Plattformunabhängigkeit}
Eine Stärke von \brand{React Native} ist die Plattformunabhängigkeit. 
Wenn keine spezifische \brand{Android}- oder \brand{iOS}-Komponenten verwendet werden, kann der Code auch für beide Plattformen genutzt werden.
Also haben wir beim Entwickeln der \brand{Android}-App darauf geachtet, möglichst keine spezifische Komponenten zu nutzen. 
Mit einer Blacklist für Komponenten, die vom React Native Packager\footnote{\url{https://github.com/facebook/react-native/tree/master/packager}} angeboten wird, konnten wir das Maximum an wiederverwendbarem Code herausholen. 
Wenn möglich wurden auch alle Dateien mit der Endung \textit{.android.js} ignoriert, da diese ein davon abweichendes Pendant für \brand{iOS} (mit der Endung \textit{.ios.js}) haben.